import{d as T}from"./popup-index.js";import{p as v,a as X,b as Z}from"./popup-index4.js";import{v as K}from"./popup-index5.js";function w(e){const t=[];let n=-1,r=0,i=0;for(;++n<e.length;){const o=e.charCodeAt(n);let l="";if(o===37&&T(e.charCodeAt(n+1))&&T(e.charCodeAt(n+2)))i=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(l=String.fromCharCode(o));else if(o>55295&&o<57344){const c=e.charCodeAt(n+1);o<56320&&c>56319&&c<57344?(l=String.fromCharCode(o,c),i=1):l="ï¿½"}else l=String.fromCharCode(o);l&&(t.push(e.slice(r,n),encodeURIComponent(l)),r=n+i+1,l=""),i&&(n+=i,i=0)}return t.join("")+e.slice(r)}function Q(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function W(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function $(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function ee(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function te(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function ne(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),i=w(r.toLowerCase()),o=e.footnoteOrder.indexOf(r);let l,c=e.footnoteCounts.get(r);c===void 0?(c=0,e.footnoteOrder.push(r),l=e.footnoteOrder.length):l=o+1,c+=1,e.footnoteCounts.set(r,c);const a={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(c>1?"-"+c:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(l)}]};e.patch(t,a);const h={type:"element",tagName:"sup",properties:{},children:[a]};return e.patch(t,h),e.applyData(t,h)}function re(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function ie(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function H(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const i=e.all(t),o=i[0];o&&o.type==="text"?o.value="["+o.value:i.unshift({type:"text",value:"["});const l=i[i.length-1];return l&&l.type==="text"?l.value+=r:i.push({type:"text",value:r}),i}function le(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return H(e,t);const i={src:w(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const o={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,o),e.applyData(t,o)}function oe(e,t){const n={src:w(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function ce(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function se(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return H(e,t);const i={href:w(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const o={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,o),e.applyData(t,o)}function ae(e,t){const n={href:w(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function pe(e,t,n){const r=e.all(t),i=n?ue(n):J(t),o={},l=[];if(typeof t.checked=="boolean"){const s=r[0];let p;s&&s.type==="element"&&s.tagName==="p"?p=s:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let c=-1;for(;++c<r.length;){const s=r[c];(i||c!==0||s.type!=="element"||s.tagName!=="p")&&l.push({type:"text",value:`
`}),s.type==="element"&&s.tagName==="p"&&!i?l.push(...s.children):l.push(s)}const a=r[r.length-1];a&&(i||a.type!=="element"||a.tagName!=="p")&&l.push({type:"text",value:`
`});const h={type:"element",tagName:"li",properties:o,children:l};return e.patch(t,h),e.applyData(t,h)}function ue(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=J(n[r])}return t}function J(e){const t=e.spread;return t??e.children.length>1}function fe(e,t){const n={},r=e.all(t);let i=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++i<r.length;){const l=r[i];if(l.type==="element"&&l.tagName==="li"&&l.properties&&Array.isArray(l.properties.className)&&l.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const o={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,o),e.applyData(t,o)}function he(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function ye(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function de(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function me(e,t){const n=e.all(t),r=n.shift(),i=[];if(r){const l={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],l),i.push(l)}if(n.length>0){const l={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},c=v(t.children[1]),a=X(t.children[t.children.length-1]);c&&a&&(l.position={start:c,end:a}),i.push(l)}const o={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,o),e.applyData(t,o)}function ge(e,t,n){const r=n?n.children:void 0,o=(r?r.indexOf(t):1)===0?"th":"td",l=n&&n.type==="table"?n.align:void 0,c=l?l.length:t.children.length;let a=-1;const h=[];for(;++a<c;){const p=t.children[a],u={},y=l?l[a]:void 0;y&&(u.align=y);let f={type:"element",tagName:o,properties:u,children:[]};p&&(f.children=e.all(p),e.patch(p,f),f=e.applyData(p,f)),h.push(f)}const s={type:"element",tagName:"tr",properties:{},children:e.wrap(h,!0)};return e.patch(t,s),e.applyData(t,s)}function be(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const E=9,U=32;function we(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),i=0;const o=[];for(;r;)o.push(M(t.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(t);return o.push(M(t.slice(i),i>0,!1)),o.join("")}function M(e,t,n){let r=0,i=e.length;if(t){let o=e.codePointAt(r);for(;o===E||o===U;)r++,o=e.codePointAt(r)}if(n){let o=e.codePointAt(i-1);for(;o===E||o===U;)i--,o=e.codePointAt(i-1)}return i>r?e.slice(r,i):""}function xe(e,t){const n={type:"text",value:we(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function Ne(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const ke={blockquote:Q,break:W,code:$,delete:ee,emphasis:te,footnoteReference:ne,heading:re,html:ie,imageReference:le,image:oe,inlineCode:ce,linkReference:se,link:ae,listItem:pe,list:fe,paragraph:he,root:ye,strong:de,table:me,tableCell:be,tableRow:ge,text:xe,thematicBreak:Ne,toml:C,yaml:C,definition:C,footnoteDefinition:C};function C(){}const Y=-1,I=0,k=1,A=2,O=3,P=4,R=5,L=6,q=7,G=8,j=typeof self=="object"?self:globalThis,Ce=(e,t)=>{const n=(i,o)=>(e.set(o,i),i),r=i=>{if(e.has(i))return e.get(i);const[o,l]=t[i];switch(o){case I:case Y:return n(l,i);case k:{const c=n([],i);for(const a of l)c.push(r(a));return c}case A:{const c=n({},i);for(const[a,h]of l)c[r(a)]=r(h);return c}case O:return n(new Date(l),i);case P:{const{source:c,flags:a}=l;return n(new RegExp(c,a),i)}case R:{const c=n(new Map,i);for(const[a,h]of l)c.set(r(a),r(h));return c}case L:{const c=n(new Set,i);for(const a of l)c.add(r(a));return c}case q:{const{name:c,message:a}=l;return n(new j[c](a),i)}case G:return n(BigInt(l),i);case"BigInt":return n(Object(BigInt(l)),i);case"ArrayBuffer":return n(new Uint8Array(l).buffer,l);case"DataView":{const{buffer:c}=new Uint8Array(l);return n(new DataView(c),l)}}return n(new j[o](l),i)};return r},F=e=>Ce(new Map,e)(0),b="",{toString:De}={},{keys:Ae}=Object,N=e=>{const t=typeof e;if(t!=="object"||!e)return[I,t];const n=De.call(e).slice(8,-1);switch(n){case"Array":return[k,b];case"Object":return[A,b];case"Date":return[O,b];case"RegExp":return[P,b];case"Map":return[R,b];case"Set":return[L,b];case"DataView":return[k,n]}return n.includes("Array")?[k,n]:n.includes("Error")?[q,n]:[A,n]},D=([e,t])=>e===I&&(t==="function"||t==="symbol"),Se=(e,t,n,r)=>{const i=(l,c)=>{const a=r.push(l)-1;return n.set(c,a),a},o=l=>{if(n.has(l))return n.get(l);let[c,a]=N(l);switch(c){case I:{let s=l;switch(a){case"bigint":c=G,s=l.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);s=null;break;case"undefined":return i([Y],l)}return i([c,s],l)}case k:{if(a){let u=l;return a==="DataView"?u=new Uint8Array(l.buffer):a==="ArrayBuffer"&&(u=new Uint8Array(l)),i([a,[...u]],l)}const s=[],p=i([c,s],l);for(const u of l)s.push(o(u));return p}case A:{if(a)switch(a){case"BigInt":return i([a,l.toString()],l);case"Boolean":case"Number":case"String":return i([a,l.valueOf()],l)}if(t&&"toJSON"in l)return o(l.toJSON());const s=[],p=i([c,s],l);for(const u of Ae(l))(e||!D(N(l[u])))&&s.push([o(u),o(l[u])]);return p}case O:return i([c,l.toISOString()],l);case P:{const{source:s,flags:p}=l;return i([c,{source:s,flags:p}],l)}case R:{const s=[],p=i([c,s],l);for(const[u,y]of l)(e||!(D(N(u))||D(N(y))))&&s.push([o(u),o(y)]);return p}case L:{const s=[],p=i([c,s],l);for(const u of l)(e||!D(N(u)))&&s.push(o(u));return p}}const{message:h}=l;return i([c,{name:a,message:h}],l)};return o},_=(e,{json:t,lossy:n}={})=>{const r=[];return Se(!(t||n),!!t,new Map,r)(e),r},S=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?F(_(e,t)):structuredClone(e):(e,t)=>F(_(e,t));function Ie(e,t){const n=[{type:"text",value:"â©"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function Be(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function Oe(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||Ie,r=e.options.footnoteBackLabel||Be,i=e.options.footnoteLabel||"Footnotes",o=e.options.footnoteLabelTagName||"h2",l=e.options.footnoteLabelProperties||{className:["sr-only"]},c=[];let a=-1;for(;++a<e.footnoteOrder.length;){const h=e.footnoteById.get(e.footnoteOrder[a]);if(!h)continue;const s=e.all(h),p=String(h.identifier).toUpperCase(),u=w(p.toLowerCase());let y=0;const f=[],g=e.footnoteCounts.get(p);for(;g!==void 0&&++y<=g;){f.length>0&&f.push({type:"text",value:" "});let d=typeof n=="string"?n:n(a,y);typeof d=="string"&&(d={type:"text",value:d}),f.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+u+(y>1?"-"+y:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(a,y),className:["data-footnote-backref"]},children:Array.isArray(d)?d:[d]})}const m=s[s.length-1];if(m&&m.type==="element"&&m.tagName==="p"){const d=m.children[m.children.length-1];d&&d.type==="text"?d.value+=" ":m.children.push({type:"text",value:" "}),m.children.push(...f)}else s.push(...f);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+u},children:e.wrap(s,!0)};e.patch(h,x),c.push(x)}if(c.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...S(l),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(c,!0)},{type:"text",value:`
`}]}}const B={}.hasOwnProperty,Pe={};function Re(e,t){const n=t||Pe,r=new Map,i=new Map,o=new Map,l={...ke,...n.handlers},c={all:h,applyData:Te,definitionById:r,footnoteById:i,footnoteCounts:o,footnoteOrder:[],handlers:l,one:a,options:n,patch:Le,wrap:Ue};return K(e,function(s){if(s.type==="definition"||s.type==="footnoteDefinition"){const p=s.type==="definition"?r:i,u=String(s.identifier).toUpperCase();p.has(u)||p.set(u,s)}}),c;function a(s,p){const u=s.type,y=c.handlers[u];if(B.call(c.handlers,u)&&y)return y(c,s,p);if(c.options.passThrough&&c.options.passThrough.includes(u)){if("children"in s){const{children:g,...m}=s,x=S(m);return x.children=c.all(s),x}return S(s)}return(c.options.unknownHandler||Ee)(c,s,p)}function h(s){const p=[];if("children"in s){const u=s.children;let y=-1;for(;++y<u.length;){const f=c.one(u[y],s);if(f){if(y&&u[y-1].type==="break"&&(!Array.isArray(f)&&f.type==="text"&&(f.value=z(f.value)),!Array.isArray(f)&&f.type==="element")){const g=f.children[0];g&&g.type==="text"&&(g.value=z(g.value))}Array.isArray(f)?p.push(...f):p.push(f)}}}return p}}function Le(e,t){e.position&&(t.position=Z(e))}function Te(e,t){let n=t;if(e&&e.data){const r=e.data.hName,i=e.data.hChildren,o=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const l="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:l}}n.type==="element"&&o&&Object.assign(n.properties,S(o)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function Ee(e,t){const n=t.data||{},r="value"in t&&!(B.call(n,"hProperties")||B.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Ue(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function z(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function V(e,t){const n=Re(e,t),r=n.one(e,void 0),i=Oe(n),o=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&o.children.push({type:"text",value:`
`},i),o}function _e(e,t){return e&&"run"in e?async function(n,r){const i=V(n,{file:r,...t});await e.run(i,r)}:function(n,r){return V(n,{file:r,...e||t})}}export{_e as default,Ie as defaultFootnoteBackContent,Be as defaultFootnoteBackLabel,ke as defaultHandlers};
